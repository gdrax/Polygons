<!DOCTYPE html>
<html>
<head>
	<title>test</title>
</head>
<style type="text/css">
	html, body {
			width: 100%;
			height: 100%;
			margin: 0px;
	}
	canvas {
		width: 100%;
		height: 100%;
		margin-bottom: 0px;
		cursor: none;
	}
</style>
<body>
<canvas id="canvas" onclick="turnGravity()" onmousemove="updateMouseCoordinates(event)" onkeypress="keyPressed(event)"> </canvas>
<script type="text/javascript">
	canvas = document.getElementById("canvas");
	ctx = canvas.getContext("2d");

	canvas.width = window.innerWidth;
	canvas.height = window.innerHeight;

	window.onresize = resize();

	function resize() {
		canvas.width = window.innerWidth;
		canvas.height = window.innerHeight;
	}

	var mouseX = -1;
	var mouseY = -1;
	var gameState = null;
	var keyPressed;
	var title = null;
	var lights = true;

	changeGameState("opening");

	/*
	cambia lo stato del gioco
	*/
	function changeGameState(newState) {
		gameState = newState;
		clearArea();
		initializeObjects();
		setListeners();
	}

	/*
	pulisce l'area di gioco
	*/
	function clearArea() {
		ctx.clearRect(0, 0, canvas.width, canvas.height);
		ctx.fillStyle = 'rgb(10, 10, 10)'
		ctx.fillRect(0, 0, canvas.width, canvas.height);
	}

	/*
	disegna l'area e gli elementi di gioco
	*/
	function drawArea() {
		clearArea();
		switch (gameState) {
			case "opening":
					title.draw(canvas.width/2-canvas.width/17, canvas.height/2+canvas.height/10, canvas.height/20, lights);
					break;
			case "levels": break;
			case "playing": break;
		}
	}

	/*
	inizializza gli oggetti
	*/
	function initializeObjects() {
		switch (gameState) {
			case "opening":
					title = new neonString(new Color(255, 255, 255), new Color(0, 255, 0), "Start game");
					break;
			case "levels": break;
			case "playing": break;
		}
	}

	/*
	imposta i listener per mouse e tastiera
	*/
	function setListeners() {
		switch (gameState) {
			case "opening":
					drawArea();
					break;
			case "levels": break;
			case "playing": break;
		}
	}

	
	function roundRectange(x, y, width, height, color) {

	}

	/*
	oggetto per generare colori
	*/
	function Color(red, green, blue) {
		this.red = red;
		this.green = green;
		this.blue = blue;
		this.hex = red.toString(16)+green.toString(16)+blue.toString(16);
		this.color = "rgba(0, 0, 0, 0)";

		this.makeColor = function(opacity) {
			this.color = "rgba("+red+", "+green+", "+blue+", "+opacity+")";
			return this.color;
		}

		this.makeHexColor = function() {
			return "#"+this.hex;
		}
	}

	/*
	stringa con effetto neon
	*/
	function neonString(color, shadowColor, text) {
		this.color = color.makeColor(1);
		this.shadowColor = shadowColor.makeColor(1);
		this.text = text;

		this.draw = function(x, y, size, lights) {
				ctx.font = size+"px Serif";
				ctx.shadowBlur = 10;
				ctx.shadowColor = this.shadowColor;
				ctx.shadowOffsetX = size/100;
				ctx.shadowOffsetY = size/100;

				if (lights) {
					//this.drawLight(x-size/600, y-size/600);
					//this.drawLight(x+size/1200, y+size/1200);
					this.drawLight(x-size/1200, y+size/1200);
					this.drawLight(x+size/1200, y-size/1200);
				}
				ctx.strokeStyle = this.color;
				ctx.strokeText(this.text, x, y);
		}

		this.drawLight = function(x, y) {
			ctx.shadowColor = this.shadowColor;
			ctx.strokeStyle = this.shadowColor;
			ctx.strokeText(this.text, x, y);
		}
	}

	/*
	salva l'ultimo tasto premuto
	*/
	function keyPressed(event) {
		keyPressed = event.keyCode();
	}

</script>
</body>
</html>
